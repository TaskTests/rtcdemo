(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{125:function(e,t){},128:function(e,t,n){},129:function(e,t,n){},130:function(e,t,n){},131:function(e,t,n){"use strict";n.r(t);var c=n(1),r=n.n(c),a=n(13),o=n.n(a),i=(n(94),n(95),n(39)),u=n(7),l=n(157),s=n(150),d=function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(i.b,{to:"/room/"+Object(l.a)()},r.a.createElement(s.a,{size:"small",variant:"outlined",color:"primary"},"Start Class")))},m=n(78),f=n(18),h=n(154),g=n(44),E=n.n(g),v=(n(128),n(75)),b=n(155),p=n(151),w=n(57),k=n(30),j=n(77),O=n(29),T=n(156),C=n(54);n(129);function I(){var e=Object(c.useRef)(),t=Object(c.useRef)(),n=!1,a=0,o=0,i=0,u=0,l="black",s=2;function d(c,r){"down"===c?(a=o,i=u,o=r.clientX-e.current.offsetLeft,u=r.clientY-e.current.offsetTop,n=!0,!0&&(t.current.beginPath(),t.current.fillStyle=l,t.current.fillRect(o,u,2,2),t.current.closePath(),!1)):"move"===c?n&&(a=o,i=u,o=r.clientX-e.current.offsetLeft,u=r.clientY-e.current.offsetTop,t.current.beginPath(),t.current.moveTo(a,i),t.current.lineTo(o,u),t.current.strokeStyle=l,t.current.lineWidth=s,t.current.stroke(),t.current.closePath()):"up"!==c&&"out"!==c||(n=!1)}Object(c.useEffect)((function(){e.current.width=window.innerWidth,e.current.height=window.innerHeight,t.current=e.current.getContext("2d"),e.current.addEventListener("mousemove",(function(e){return d("move",e)}),!1),e.current.addEventListener("mousedown",(function(e){return d("down",e)}),!1),e.current.addEventListener("mouseup",(function(e){return d("up",e)}),!1),e.current.addEventListener("mouseout",(function(e){return d("out",e)}),!1)}),[]);return r.a.createElement(h.a,{className:"WhiteBoard",width:"100%",height:"100%",bgcolor:"white",color:"black"},r.a.createElement(h.a,{position:"absolute",right:"0",margin:"1em 1.5em"},r.a.createElement(b.a,{title:"Clear"},r.a.createElement(p.a,{color:"primary","aria-label":"upload picture",component:"span",onClick:function(){t.current.clearRect(0,0,e.current.width,e.current.height)}},r.a.createElement(C.a,null)))),r.a.createElement("canvas",{ref:e}))}var R=function(e){var t=e.match.params.roomId,n=Object(c.useRef)(),a=Object(c.useRef)(),o=Object(c.useRef)(null),i=Object(c.useRef)(),u=Object(c.useRef)([]),l=Object(c.useRef)([]),d=Object(v.a)(),g=Object(f.a)(d,2),C=g[0],R=g[1],y=r.a.useState(!0),S=Object(f.a)(y,2),D=S[0],N=S[1],x=r.a.useState(!0),P=Object(f.a)(x,2),L=P[0],A=P[1],z=r.a.useState(!1),V=Object(f.a)(z,2),M=V[0],W=V[1],B=Object(c.useState)(!0),G=Object(f.a)(B,2),F=G[0],Y=G[1],J=Object(c.useState)(),U=Object(f.a)(J,2),X=(U[0],U[1]);Object(c.useEffect)((function(){navigator.mediaDevices.getUserMedia({video:!0,audio:!0}).then((function(e){n.current.srcObject=e,a.current=e})).catch((function(e){alert("Error:".concat(e))}))}),[]);function H(e){var t=function(e){var t=new RTCPeerConnection({iceServers:[{urls:["stun:stun1.l.google.com:19302","stun:stun2.l.google.com:19302"]}]});return t.onicecandidate=function(t){!function(e,t){e.candidate&&i.current.emit("ice-candidate",{to:t,candidate:e.candidate})}(t,e)},t.ontrack=function(t){!function(e,t){C(t).current.srcObject=e.streams[0]}(t,e)},t.onsignalingstatechange=function(e){console.log("SIGNAL STATE:".concat(e.target.signalingState))},t.onnegotiationneeded=$,t}(e.from),n=new RTCSessionDescription(e.sdp);t.setRemoteDescription(n).then((function(){a.current.getTracks().forEach((function(e){var n=t.addTrack(e,a.current);"video"===e.kind&&(l.current.push(n),null!=o.current&&n.replaceTrack(o.current))}))})).then((function(){return t.createAnswer()})).then((function(e){t.setLocalDescription(e)})).then((function(){i.current.emit("answer",{to:e.from,sdp:t.localDescription})})),u.current.push({userID:e.from,peer:t}),X(e.from)}function $(){console.log("handleNegotiation")}var q=function(e){"audio"===e.target.name?(a.current.getAudioTracks()[0].enabled=e.target.checked,N(e.target.checked)):(a.current.getVideoTracks()[0].enabled=e.target.checked,A(e.target.checked))};return r.a.createElement(h.a,{width:"100vw",height:"100vh",bgcolor:"black",className:"createRoom",display:"flex",flexDirection:"column"},r.a.createElement(h.a,{width:"100vw",height:"100vh",color:"white",flexGrow:"1",paddingBottom:"10vh"},r.a.createElement(h.a,{width:"100%",height:"100%",hidden:F,bgcolor:"white",color:"black"},r.a.createElement(I,null)),r.a.createElement(h.a,{width:"100%",height:"100%",hidden:!F,style:{overflowY:"scroll"}},r.a.createElement("video",{height:"100%",muted:!0,autoPlay:!0,ref:n,className:"MyVideo"}),u.current.map((function(e){return r.a.createElement("video",{key:e.userID,autoPlay:!0,ref:R(e.userID),className:"MyVideo"})})))),r.a.createElement(h.a,{position:"absolute",bottom:"0",width:"100%",height:"10vh",color:"white",padding:"0em 1em 0.5em 1em",bgcolor:"rgb(25 25 25)",display:"flex",alignItems:"center",justifyContent:"space-between"},r.a.createElement("div",null,r.a.createElement(T.a,{checked:F,icon:r.a.createElement(w.b,{color:"white"}),checkedIcon:r.a.createElement(w.a,{color:"white"}),onChange:function(e){var t=e.target.checked;Y(t)}}),r.a.createElement(r.a.Fragment,null,r.a.createElement(b.a,{title:"Share screen"},r.a.createElement(p.a,{color:"primary","aria-label":"upload picture",component:"span",onClick:function(){navigator.mediaDevices.getDisplayMedia({cursor:!0}).then((function(e){var t=e.getTracks()[0];o.current=t,t.onended=function(){o.current=null,l.current.forEach((function(e){e.replaceTrack(a.current.getVideoTracks()[0])}))},0!==u.current.length&&l.current.forEach((function(e){e.replaceTrack(t)}))}))}},r.a.createElement(j.a,{color:"white"}))))),r.a.createElement("div",null,r.a.createElement(T.a,{checkedIcon:r.a.createElement(O.b,{color:"white"}),icon:r.a.createElement(k.a,{color:"white"}),checked:D,name:"audio",onChange:q}),r.a.createElement(T.a,{checkedIcon:r.a.createElement(O.a,{color:"white"}),icon:r.a.createElement(k.b,{color:"white"}),checked:L,name:"video",onChange:q})),r.a.createElement("div",null,M?r.a.createElement(s.a,{className:"btn",size:"small",variant:"contained",color:"secondary",onClick:function(){i.current.disconnect(),u.current=[],X("callEnd"),W(!1)}},"LEAVE"):r.a.createElement(s.a,{className:"btn",size:"small",variant:"contained",color:"secondary",onClick:function(){i.current=E.a.connect("/"),i.current.emit("create room",t),i.current.on("offer",H),i.current.on("ice-candidate",(function(e){var t=new RTCIceCandidate(e.val),n=u.current.filter((function(t){return t.userID===e.userID}));0!==n.length&&n[0].peer.addIceCandidate(t).then((function(){console.log("Added")})).catch((function(e){console.log("candidate error:".concat(e))}))})),i.current.on("user left",(function(e){var t=u.current.filter((function(t){return t.userID!==e}));u.current=Object(m.a)(t),X(e+"disconnected")})),W(!0)}},"Go live"))))},y=(n(130),n(152)),S=function(e){var t=e.match.params.roomId,n=Object(c.useRef)(),a=Object(c.useRef)(),o=Object(c.useRef)(),i=Object(c.useRef)(),u=Object(c.useRef)(),l=r.a.useState(!0),s=Object(f.a)(l,2),d=s[0],m=s[1],h=r.a.useState(!0),g=Object(f.a)(h,2),v=g[0],b=g[1],p=r.a.useState(!1),w=Object(f.a)(p,2),j=w[0],C=w[1];Object(c.useEffect)((function(){navigator.mediaDevices.getUserMedia({video:{width:{max:640},height:{max:480}},audio:!0}).then((function(e){n.current.srcObject=e,o.current=e,I()})).catch((function(e){alert("Error:".concat(e))}))}),[]);var I=function(){i.current=E.a.connect("/"),i.current.emit("join room",t),i.current.on("hostId",R),i.current.on("answer",D),i.current.on("no room",(function(){alert("No room exist")})),i.current.on("host left",(function(){return C(!1)})),i.current.on("ice-candidate",(function(e){var t=new RTCIceCandidate(e.val);u.current.addIceCandidate(t).then((function(){console.log("Added")})).catch((function(e){console.log("candidate error:".concat(e))}))}))};function R(e){u.current=new RTCPeerConnection({iceServers:[{urls:["stun:stun1.l.google.com:19302","stun:stun2.l.google.com:19302"]}]}),o.current.getTracks().forEach((function(e){u.current.addTrack(e,o.current)})),u.current.onicecandidate=function(t){!function(e,t){if(e.candidate){var n={to:t,candidate:e.candidate};i.current.emit("ice-candidate",n)}}(t,e)},u.current.ontrack=S,u.current.onnegotiationneeded=function(){var t;t=e,u.current.createOffer().then((function(e){u.current.setLocalDescription(e)})).then((function(){var e={to:t,sdp:u.current.localDescription};i.current.emit("offer",e)})).catch((function(e){alert("Error occured : ".concat(e))}))},u.current.onsignalingstatechange=function(e){console.log("SIGNAL STATE:".concat(e.target.signalingState))}}function S(e){C(!0),a.current.srcObject=e.streams[0]}function D(e){var t=new RTCSessionDescription(e.sdp);u.current.setRemoteDescription(t).catch((function(e){return alert("Error:".concat(e))}))}var N=function(e){"audio"===e.target.name?(o.current.getAudioTracks()[0].enabled=e.target.checked,m(e.target.checked)):(o.current.getVideoTracks()[0].enabled=e.target.checked,b(e.target.checked))},x=function(){return r.a.createElement("div",{className:"loader"},r.a.createElement(y.a,null),r.a.createElement("p",null,"Connectng..."))};return r.a.createElement("div",{className:"main"},j||a.current?"":r.a.createElement(x,null),r.a.createElement("div",{className:"video-container"},r.a.createElement("video",{muted:!0,ref:n,autoPlay:!0,hidden:j}),r.a.createElement("video",{ref:a,autoPlay:!0,hidden:!j})),r.a.createElement("div",{className:"toolbar"},r.a.createElement("div",null,r.a.createElement(T.a,{checkedIcon:r.a.createElement(O.b,{color:"white",size:"32"}),icon:r.a.createElement(k.a,{color:"white",size:"32"}),checked:d,name:"audio",onChange:N,inputProps:{"aria-label":"primary checkbox"}}),r.a.createElement(T.a,{checkedIcon:r.a.createElement(O.a,{color:"white",size:"32"}),icon:r.a.createElement(k.b,{color:"white",size:"32"}),checked:v,name:"video",onChange:N,inputProps:{"aria-label":"primary checkbox"}}))))};var D=function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(i.a,null,r.a.createElement(u.c,null,r.a.createElement(u.a,{path:"/",exact:!0,component:d}),r.a.createElement(u.a,{path:"/room/:roomId",component:R}),r.a.createElement(u.a,{path:"/join/:roomId",component:S}))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(D,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},89:function(e,t,n){e.exports=n(131)},94:function(e,t,n){},95:function(e,t,n){}},[[89,1,2]]]);
//# sourceMappingURL=main.2b6bb82d.chunk.js.map